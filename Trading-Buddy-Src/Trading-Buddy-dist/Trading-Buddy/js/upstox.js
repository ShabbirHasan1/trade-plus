const CALL="CALL",PUT="PUT",NO_OF_STRIKE=10;let cols={},strikePriceOrder={},spotPrice=0;function getColumnPosition(i,t,e){let l={};return i.find("thead th").each((i,t)=>{let e=$(t).text().replace(/\s/g,"").toLowerCase();e.includes("oi&change")&&(l.callOICol=i+1),e.includes("volume")&&(l.callVolume=i+1),e.includes("ltp&change")&&(l.callCol=i+1),e.includes("oipercent")&&(l.callOIChange=i+1)}),t.find("thead th").each((i,t)=>{let e=$(t).text().replace(/\s/g,"").toLowerCase();e.includes("strikeprice")&&(l.strikeCol=i+1)}),e.find("thead th").each((i,t)=>{let e=$(t).text().replace(/\s/g,"").toLowerCase();e.includes("oi&change")&&(l.putOICol=i+1),e.includes("volume")&&(l.putVolume=i+1),e.includes("ltp&change")&&(l.putCol=i+1),e.includes("oipercent")&&(l.putOIChange=i+1)}),l}function isNumeric(i){return"string"==typeof i&&(!isNaN(i)&&!isNaN(parseFloat(i)))}function sortByKey(i,e){return i.sort((i,t)=>t[e]-i[e])}function highlightSR(i,t,e){t.find("tr.chips-hawa-ltp-img-line").removeClass("chips-hawa-ltp-img-line"),t.find(".chips-hawa-sr-cell").removeClass("chips-hawa-sr-cell"),e.find("tr.chips-hawa-ltp-img-line").removeClass("chips-hawa-ltp-img-line"),e.find(".chips-hawa-sr-cell").removeClass("chips-hawa-sr-cell"),t.find(`tr:nth-child(${i.soptRow})`).addClass("chips-hawa-ltp-img-line"),e.find(`tr:nth-child(${i.soptRow})`).addClass("chips-hawa-ltp-img-line"),t.find(`tr:nth-child(${i.maxResVol}) td:nth-child(${cols.callVolume})`).addClass("chips-hawa-sr-cell"),t.find(`tr:nth-child(${i.maxResOI}) td:nth-child(${cols.callOICol})`).addClass("chips-hawa-sr-cell"),e.find(`tr:nth-child(${i.maxSupVol}) td:nth-child(${cols.putVolume})`).addClass("chips-hawa-sr-cell"),e.find(`tr:nth-child(${i.maxSupOI}) td:nth-child(${cols.putOICol})`).addClass("chips-hawa-sr-cell")}function updateLTP(){var[t,e,l]=$("#root section table");if(null!=t&&null!=e&&null!=l){let m=[],f=[],g=$(t),i=$(e),C=$(l);cols.strikeCol||(cols=getColumnPosition(g,i,C));let x=i.find("tr").index($("div[data-id='spotPrice']").closest("tr"));i.find("tbody td div").each((r,i)=>{let n=$(i);var h,o,p,u,r=r+1;if("spotPrice"!==n.data("id")){strikePrice=n.text().trim().replace(/[^0-9.]/g,""),strikePrice=parseFloat(strikePrice).toFixed(2),strikePriceOrder[r]=strikePrice;let i=g.find(`tr:nth-child(${r}) td:nth-child(${cols.callCol})`),t=C.find(`tr:nth-child(${r}) td:nth-child(${cols.putCol})`),e=g.find(`tr:nth-child(${r}) td:nth-child(${cols.callOICol})`),l=C.find(`tr:nth-child(${r}) td:nth-child(${cols.putOICol})`),c=g.find(`tr:nth-child(${r}) td:nth-child(${cols.callVolume})`),s=C.find(`tr:nth-child(${r}) td:nth-child(${cols.putVolume})`),d=g.find(`tr:nth-child(${r}) td:nth-child(${cols.callOIChange})`),a=C.find(`tr:nth-child(${r}) td:nth-child(${cols.putOIChange})`);r>=x-1&&(h=i.find("div>div").text().trim().replace(/[^0-9.]/g,""),o=e.find("div:nth-child(1)").text().trim().replace(/[^0-9.]/g,""),p=c.find("div:nth-child(1)").text().trim().replace(/[^0-9.]/g,""),u=d.find("div:nth-child(1)").text().trim().replace(/[^0-9.]/g,""),m.push({index:r,strike:strikePrice,price:parseFloat(h).toFixed(2),oi:isNumeric(o)?parseFloat(o):0,volume:isNumeric(p)?parseFloat(p):0,oiChangePer:isNumeric(u)?parseFloat(u):0})),r<=x+1&&(h=t.find("div>div").text().trim().replace(/[^0-9.]/g,""),o=l.find("div:nth-child(1)").text().trim().replace(/[^0-9.]/g,""),p=s.find("div:nth-child(1)").text().trim().replace(/[^0-9.]/g,""),u=a.find("div:nth-child(1)").text().trim().replace(/[^0-9.]/g,""),f.push({index:r,strike:strikePrice,price:parseFloat(h).toFixed(2),oi:isNumeric(o)?parseFloat(o):0,volume:isNumeric(p)?parseFloat(p):0,oiChangePer:isNumeric(u)?parseFloat(u):0}))}else spotPrice=n.text().trim().replace(/[^0-9.]/g,"")});var c=sortByKey(f,"volume")[0].index,t=sortByKey(f,"oi")[0].index,e=sortByKey(m,"volume")[0].index,l=sortByKey(m,"oi")[0].index;highlightSR({soptRow:x,maxSupVol:c,maxSupOI:t,maxResVol:e,maxResOI:l},g,C)}}function main(){setInterval(updateLTP,1200)}main();